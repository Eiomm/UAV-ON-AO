# UAV-ON 项目Python文件详细说明

## 目录

- [根目录文件](#根目录文件)
- [airsim_plugin模块](#airsim_plugin模块)
- [src核心模块](#src核心模块)
- [src/common配置模块](#srccommon配置模块)
- [src/model_wrapper模型包装器](#srcmodel_wrapper模型包装器)
- [utils工具模块](#utils工具模块)
- [整体架构流程](#整体架构流程)

---

## 根目录文件

### data.py

**文件功能：**

- 从Hugging Face下载UAV-ON数据集
- 使用`datasets`库加载`Kyaren/UAV-ON-dataset`
- 将数据集保存到本地`./uav-on-dataset`目录

**与其他文件的联动：**

- **独立运行**：作为数据准备的初始化脚本，不依赖其他模块
- **数据产出**：为后续所有评估脚本提供原始数据集
- **下游消费**：生成的数据集被`src/env_uav.py`中的`load_my_datasets()`方法加载

---

### Task_visualization.py

**文件功能：**

- 读取实验日志中的轨迹数据（trajectory.jsonl）和目标描述（object_description.json）
- 解析无人机的飞行轨迹（位置、方向）
- 使用matplotlib的3D绘图功能可视化：
  - 起点、终点位置
  - 飞行轨迹路径
  - 方向向量（朝向）

**与其他文件的联动：**

- **输入依赖**：读取`logs/scene/*/task_*/`目录下的文件
  - `object_description.json`：由`src/closeloop_util.py`的`save_to_dataset_eval()`生成
  - `log/trajectory.jsonl`：由`src/closeloop_util.py`的`save_logs()`生成
- **独立运行**：作为后处理工具，不影响主流程
- **用途**：帮助研究人员直观理解无人机的导航行为和路径规划效果

---

## airsim_plugin模块

### airsim_plugin/airsim_settings.py

**文件功能：**

- 定义AirSim仿真器的动作参数配置
- 使用单例模式确保全局唯一配置
- 配置项包括：
  - `FORWARD_STEP_SIZE`：前进步长
  - `UP_DOWN_STEP_SIZE`：垂直移动步长
  - `LEFT_RIGHT_STEP_SIZE`：左右平移步长
  - `TURN_ANGLE`：旋转角度

**与其他文件的联动：**

- **参数来源**：从`src/common/param.py`的`args`读取配置值
- **被调用者**：
  - `utils/env_utils_uav.py`的`getNextPosition()`计算下一步位置
  - `src/model_wrapper/CLIP_H.py`的`redirect_action()`边界检查
  - `airsim_plugin/AirVLNSimulatorClientTool.py`执行动作
- **作用**：统一管理所有动作的步长/角度，确保一致性

---

### airsim_plugin/AirVLNSimulatorClientTool.py

**文件功能：**

- **传感器封装**：
  - `State`类：获取无人机状态（位置、速度、加速度、姿态、碰撞信息）
  - `Imu`类：获取IMU数据（角速度、线性加速度）
- **仿真客户端管理**：
  - 连接到多个AirSim仿真器实例
  - 管理多架无人机的并行控制
  - 执行移动指令（`moveToPositionAsync`、`rotateToYawAsync`）
  - 捕获RGB图像和深度图像
- **线程安全**：使用`MyThread`实现异步数据获取

**与其他文件的联动：**

- **服务端协同**：与`AirVLNSimulatorServerTool.py`配合（客户端-服务端架构）
- **被调用者**：
  - `src/env_uav.py`的`AirVLNENV`类通过此工具与仿真器交互
  - `utils/env_vector_uav.py`的`VectorEnvUtil`管理多个客户端实例
- **数据提供**：
  - 为`src/model_wrapper/`提供RGB图像（用于VLM输入）
  - 为`src/model_wrapper/`提供深度图像（用于避障决策）
  - 为`utils/env_utils_uav.py`提供位置、姿态等状态信息

---

### airsim_plugin/AirVLNSimulatorServerTool.py

**文件功能：**

- **仿真环境管理**：
  - 生成AirSim的`settings.json`配置文件
  - 配置相机参数（FOV、分辨率、图像类型）
  - 配置物理引擎参数（ClockSpeed、频率）
- **进程管理**：
  - 启动和关闭Unreal Engine仿真器进程
  - 管理多个场景的并行仿真
- **RPC服务**：使用msgpack-rpc提供远程调用接口

**与其他文件的联动：**

- **配置模板**：使用预定义的`AIRSIM_SETTINGS_TEMPLATE`
- **客户端配对**：为`AirVLNSimulatorClientTool.py`准备仿真环境
- **启动流程**：在评估开始前被调用，初始化仿真环境
- **资源管理**：评估结束后负责清理仿真器进程

---

## src核心模块

### src/closeloop_util.py

**文件功能：**

- **环境初始化**：
  - `setup()`：设置随机种子、分布式训练环境
  - `initialize_env()`/`initialize_env_eval()`：创建`AirVLNENV`实例
- **批次迭代器**：
  - `BatchIterator`类：封装环境的批次遍历逻辑
- **评估状态管理**：
  - `EvalBatchState`类：跟踪每个批次的评估状态
    - 成功/失败标记
    - 碰撞记录
    - 距离目标的距离历史
    - 轨迹数据收集
- **数据保存**：
  - `save_to_dataset_eval()`：保存评估结果
  - `save_logs()`：将轨迹保存为JSONL格式

**与其他文件的联动：**

- **核心协调者**：被所有评估脚本导入
  - `src/eval_2.py`
  - `src/eval_cliph.py`
  - `src/eval_random.py`
- **环境创建**：调用`src/env_uav.py`的`AirVLNENV`类
- **参数依赖**：从`src/common/param.py`读取配置
- **工具依赖**：调用`utils/utils.py`的分布式工具函数
- **数据产出**：生成的日志被`Task_visualization.py`、`utils/classify_metric.py`分析

---

### src/env_uav.py

**文件功能：**

- **数据集管理**：
  - `load_my_datasets()`：加载JSON格式的任务数据
  - `_group_scenes()`：按场景对任务分组
  - 跟踪已使用的任务ID，避免重复
- **批次采样**：
  - `next_minibatch()`：生成批量任务
  - 支持场景过滤（skip_scenes）
  - 处理epoch结束和数据打乱
- **环境交互**：
  - `makeActions()`：执行动作序列
  - `get_obs()`：获取观测数据
  - `changeToNewTask()`：切换到新任务
- **仿真器管理**：
  - `init_VectorEnvUtil()`：初始化多进程环境
  - `delete_VectorEnvUtil()`：清理资源

**与其他文件的联动：**

- **仿真器接口**：
  - 通过`utils/env_vector_uav.py`的`VectorEnvUtil`管理多个仿真器
  - `VectorEnvUtil`内部使用`airsim_plugin/AirVLNSimulatorClientTool.py`
- **状态管理**：使用`utils/env_utils_uav.py`的`SimState`类
- **数据加载**：读取`data.py`生成的数据集
- **被调用者**：
  - 所有评估脚本（`eval_2.py`、`eval_cliph.py`、`eval_random.py`）
  - `src/closeloop_util.py`的初始化函数
- **观测数据流**：
  - 提供RGB图像 → `src/model_wrapper/`
  - 提供深度图 → `src/model_wrapper/`
  - 提供位置信息 → `EvalBatchState`

---

### src/eval_2.py

**文件功能：**

- **主评估流程**：
  - 初始化环境和模型（ONAir）
  - 循环处理每个批次的任务
  - 执行最多150步的导航
- **模型调用**：
  - `prepare_inputs()`：准备多模态输入（图像+文本提示）
  - `run()`：获取模型预测的动作
- **动作执行与状态更新**：
  - 调用环境执行动作
  - 更新评估状态
  - 检查终止条件
- **结果保存**：通过`EvalBatchState`保存轨迹和指标

**与其他文件的联动：**

- **环境依赖**：
  - 使用`src/closeloop_util.py`的`initialize_env_eval()`创建环境
  - 使用`BatchIterator`和`EvalBatchState`
- **模型依赖**：
  - 使用`src/model_wrapper/ON_Air_2.py`的`ONAir`类
- **参数依赖**：从`src/common/param.py`读取所有配置
- **日志依赖**：使用`utils/logger.py`记录进度
- **执行流程**：
  1. 环境生成批次 → 
  2. 模型准备输入（包含视觉+语言） → 
  3. 模型预测动作 → 
  4. 环境执行动作 → 
  5. 获取新观测 → 
  6. 更新状态 → 
  7. 重复直到终止

---

### src/eval_cliph.py

**文件功能：**

- CLIP-H基线模型的评估脚本
- 流程与`eval_2.py`类似，但使用不同的模型：
  - 使用`src/model_wrapper/CLIP_H.py`
  - 基于图像-文本相似度进行决策
  - 不需要固定/非固定步长模式选择

**与其他文件的联动：**

- **模型依赖**：使用`src/model_wrapper/CLIP_H.py`的`CLIP_H`类
- **其他依赖**：与`eval_2.py`相同的环境和工具
- **对比实验**：与`eval_2.py`的结果对比，评估ON-Air的优越性

---

### src/eval_random.py

**文件功能：**

- 随机基线评估脚本
- 前10步从有限动作集随机选择
- 第10步后加入"stop"动作
- 用于建立性能下界（baseline）

**与其他文件的联动：**

- **环境依赖**：与`eval_2.py`相同
- **无模型依赖**：不使用任何模型，纯随机策略
- **基准作用**：为其他方法提供最低性能参考

---

## src/common配置模块

### src/common/param.py

**文件功能：**

- 使用`argparse`定义所有命令行参数：
  - **环境参数**：批次大小、最大步数
  - **动作参数**：步长、旋转角度
  - **模型参数**：模型路径、GPU ID
  - **数据参数**：数据集路径
  - **评估参数**：保存路径、固定/非固定模式
- 提供全局单例`args`供所有模块访问

**与其他文件的联动：**

- **全局配置中心**：几乎所有文件都导入此模块
- **直接依赖者**（部分列举）：
  - `airsim_plugin/airsim_settings.py`：读取步长和角度
  - `src/env_uav.py`：读取批次大小、端口号
  - 所有评估脚本：读取数据集路径、保存路径等
  - `utils/logger.py`：读取日志配置
- **配置流**：命令行参数 → `args` → 各模块配置

---

### src/common/prompts.py

**文件功能：**

- 定义两种模式的提示词模板：
  - **固定步长模式**：`fixed_system_prompt`、`fixed_user_prompt_template`
  - **非固定步长模式**：`unfixed_system_prompt`、`unfixed_user_prompt_template`
- 提示词包含：
  - 任务目标描述
  - 坐标系统说明
  - 导航约束（边界、步数限制）
  - 高度调整策略
  - 动作格式要求
  - 视觉观测（captions、depth）
  - 历史位置

**与其他文件的联动：**

- **被调用者**：
  - `src/model_wrapper/ON_Air_2.py`：导入并使用提示词模板
  - 在`prepare_inputs()`中填充具体任务信息
- **提示词工程**：
  - 结合视觉captions（由`Qwen_api_captions.py`生成）
  - 结合深度信息（由环境提供）
  - 结合历史轨迹（由`SimState`维护）
- **模式切换**：根据`args.is_fixed`选择不同模板

---

## src/model_wrapper模型包装器

### src/model_wrapper/base_model.py

**文件功能：**

- 定义所有模型包装器的抽象基类
- 接口方法：
  - `prepare_inputs()`：准备模型输入
  - `run()`：执行模型推理
  - `eval()`：切换到评估模式

**与其他文件的联动：**

- **被继承者**：
  - `ON_Air_2.py`的`ONAir`类
  - `CLIP_H.py`的`CLIP_H`类
- **接口规范**：确保不同模型有统一的调用接口
- **多态性**：评估脚本可以无缝切换不同模型

---

### src/model_wrapper/CLIP_H.py

**文件功能：**

- **模型加载**：加载OpenAI的CLIP-ViT-Base-Patch16模型
- **启发式决策**：
  - 计算图像-文本相似度
  - 选择相似度最高的方向动作
  - 超过阈值则执行"stop"
- **冲突避免**：
  - 检测连续的相反动作（左↔右）
  - 检测低高度时的下降动作
- **边界保护**：
  - `redirect_action()`检查动作是否越界
  - 越界则替换为旋转动作

**与其他文件的联动：**

- **基类**：继承`base_model.py`的`BaseModelWrapper`
- **配置依赖**：使用`airsim_plugin/airsim_settings.py`的步长
- **评估脚本**：被`src/eval_cliph.py`实例化和调用
- **输入数据**：
  - RGB图像来自环境
  - 描述文本来自数据集
- **动作限制**：与ON-Air使用相同的边界检查逻辑

---

### src/model_wrapper/ON_Air_2.py

**文件功能：**

- **核心模型包装器**：封装Qwen多模态大语言模型
- **视觉理解**：
  - 调用`Qwen_api_captions.py`生成图像描述
  - 批量处理图像（8张/批次）
- **提示词构建**：
  - 整合视觉captions、深度信息、历史轨迹
  - 根据固定/非固定模式选择提示词模板
  - 计算边界范围（起点±50米）
- **异步推理**：
  - 使用`AsyncOpenAI`客户端
  - `batch_calls()`并行处理多个对话
- **动作解析**：
  - 固定模式：解析动作名称
  - 非固定模式：解析`[action, value]`格式

**与其他文件的联动：**

- **基类**：继承`base_model.py`的`BaseModelWrapper`
- **提示词**：从`src/common/prompts.py`导入模板
- **图像描述**：调用`Qwen_api_captions.py`的`generate_caption()`
- **评估脚本**：被`src/eval_2.py`实例化和调用
- **配置依赖**：从`src/common/param.py`读取模型路径、批次大小
- **数据流**：
  1. 接收环境的RGB+深度图像
  2. 生成captions
  3. 处理历史轨迹
  4. 构建提示词
  5. 调用Qwen API
  6. 解析动作和步长

---

### src/model_wrapper/Qwen_api_captions.py

**文件功能：**

- **图像编码**：将图像字节转为base64字符串
- **Caption生成**：
  - 调用Qwen多模态模型（通过DashScope API）
  - 批量处理多张图像
  - 提示词要求生成结构化描述：
    - 物体属性
    - 数量和分组
    - 空间关系
    - 物体状态/动作
- **错误处理**：重试机制、异常捕获

**与其他文件的联动：**

- **调用者**：`src/model_wrapper/ON_Air_2.py`的`prepare_inputs()`
- **API依赖**：使用`openai`库和`dashscope`库
- **输入数据**：RGB图像字节流（来自AirSim）
- **输出用途**：生成的captions嵌入到提示词中，帮助LLM理解场景
- **关键作用**：将视觉信息转换为语言描述，实现视觉-语言对齐

---

## utils工具模块

### utils/classify_metric.py

**文件功能：**

- **日志解析**：
  - 遍历实验日志目录结构
  - 读取`trajectory.jsonl`的最后一行
  - 提取`distance_to_end`（最终距离）
- **指标计算**：
  - 成功率（距离<20m）
  - 碰撞率
  - 平均步数
  - 平均移动距离
- **分类统计**：
  - 按物体大小（small/mid/large）分类
  - 按场景（map）分类
- **结果输出**：打印详细的统计表格

**与其他文件的联动：**

- **输入依赖**：读取由`src/closeloop_util.py`生成的日志文件
- **独立运行**：作为后处理脚本，通过命令行指定日志目录
- **用途**：
  - 评估模型性能
  - 对比不同方法
  - 分析失败案例

---

### utils/CN.py

**文件功能：**

- 基于`yacs`库实现的配置节点类
- 支持动态添加配置项（`new_allowed=True`）
- 提供层级化的配置管理

**与其他文件的联动：**

- **被导入者**：`src/common/param.py`
- **用途**：提供更灵活的配置管理方式（虽然当前项目主要用argparse）

---

### utils/env_utils_uav.py

**文件功能：**

- **状态管理类**（`SimState`）：
  - 维护任务状态（步数、是否结束、碰撞等）
  - 记录完整轨迹
  - 计算移动距离和目标距离
  - 跟踪航向变化
- **位置计算函数**（`getNextPosition`）：
  - 根据动作和当前姿态计算下一步位置
  - 支持7种动作：forward、left、right、ascend、descend、rotl、rotr
  - 处理固定/非固定步长
  - 处理航向角的360度循环
- **环境基类**（`ENV`）：
  - 批次数据管理
  - 观测数据获取接口

**与其他文件的联动：**

- **被调用者**：
  - `src/env_uav.py`：使用`SimState`维护每个任务状态
  - `utils/env_vector_uav.py`：使用`ENV`基类和`getNextPosition()`
- **配置依赖**：从`airsim_plugin/airsim_settings.py`读取步长参数
- **数据产出**：`SimState.trajectory`被保存为JSONL日志
- **核心逻辑**：实现了动作到位置变换的数学计算

---

### utils/env_vector_uav.py

**文件功能：**

- **多进程环境管理**：
  - `VectorEnvUtil`类：管理多个并行仿真器
  - 使用`torch.multiprocessing`（如果可用）
  - 每个进程运行独立的AirSim客户端
- **进程通信**：
  - `ConnectionWrapper`：使用pickle5进行数据序列化
  - 命令系统：COMMAND_CLOSE、COMMAND_SET_BATCH、COMMAND_GET_OBS
- **批次分发**：
  - 将批量任务分配到不同进程
  - 并行执行观测获取
- **资源管理**：
  - 进程生命周期管理
  - 安全关闭和清理

**与其他文件的联动：**

- **被调用者**：`src/env_uav.py`的`init_VectorEnvUtil()`
- **底层依赖**：
  - `utils/env_utils_uav.py`：使用`ENV`基类
  - `utils/pickle5_multiprocessing.py`：使用序列化工具
  - `airsim_plugin/AirVLNSimulatorClientTool.py`：每个进程创建客户端实例
- **参数依赖**：从`src/common/param.py`读取端口等配置
- **性能优化**：通过并行化提升仿真效率，支持大批次评估

---

### utils/logger.py

**文件功能：**

- 自定义日志类（`AirsimLogger`）
- 支持：
  - 控制台输出（StreamHandler）
  - 文件输出（FileHandler）
  - 分布式训练时添加rank前缀
- 日志格式：时间戳、日志级别、函数名、行号、消息
- 创建全局单例`logger`供项目使用

**与其他文件的联动：**

- **被导入者**：几乎所有模块
  - `src/env_uav.py`
  - `src/eval_2.py`
  - `airsim_plugin/AirVLNSimulatorClientTool.py`
  - 等等
- **配置依赖**：从`src/common/param.py`读取日志文件路径
- **用途**：统一的日志记录接口，便于调试和监控

---

### utils/merge_json.py

**文件功能：**

- 合并多个JSON数据集文件
- 为每个episode重新分配唯一的episode_id
- 将合并结果保存为单个JSON文件

**与其他文件的联动：**

- **独立运行**：数据预处理工具
- **输入**：多个独立的场景JSON文件
- **输出**：合并后的数据集，供`src/env_uav.py`加载
- **用途**：简化数据集管理，方便跨场景评估

---

### utils/pickle5_multiprocessing.py

**文件功能：**

- 提供pickle5协议的兼容性支持
- Python 3.8以下使用pickle5 backport
- `ForkingPickler5`：扩展的序列化器
- `ConnectionWrapper`：封装多进程连接，使用pickle5序列化

**与其他文件的联动：**

- **被调用者**：`utils/env_vector_uav.py`
- **用途**：
  - 在进程间传递复杂对象（如numpy数组、torch张量）
  - 提高序列化性能
  - 支持大数据对象传输

---

### utils/utils.py

**文件功能：**

- **分布式训练工具**：
  - `init_distributed_mode()`：初始化torch.distributed
  - `get_rank()`、`get_world_size()`：获取进程信息
  - `is_main_process()`：判断是否为主进程
- **环境变量读取**：RANK、WORLD_SIZE、LOCAL_RANK
- **GPU设置**：`torch.cuda.set_device()`

**与其他文件的联动：**

- **被调用者**：`src/closeloop_util.py`的`setup()`
- **参数写入**：修改`src/common/param.py`的`args.DistributedDataParallel`
- **用途**：支持多GPU并行评估（虽然当前项目主要用单GPU）

---

## 整体架构流程

### 1. 数据准备阶段
```
data.py → 下载数据集 → 本地存储
       ↓
utils/merge_json.py → 合并多个JSON → 统一数据集
```

### 2. 环境初始化阶段
```
eval_*.py → 读取参数(param.py)
         ↓
         初始化环境(closeloop_util.py)
         ↓
         创建AirVLNENV(env_uav.py)
         ↓
         启动VectorEnvUtil(env_vector_uav.py)
         ↓
         启动仿真服务器(AirVLNSimulatorServerTool.py)
         ↓
         创建仿真客户端(AirVLNSimulatorClientTool.py)
```

### 3. 模型加载阶段
```
eval_2.py → 创建ONAir模型(ON_Air_2.py)
         → 加载Qwen API配置
         
eval_cliph.py → 创建CLIP_H模型(CLIP_H.py)
              → 加载CLIP模型权重
```

### 4. 评估循环阶段
```
┌─────────────────────────────────────────┐
│ env_uav.py: next_minibatch()           │
│ 生成批量任务                            │
└─────────────────┬───────────────────────┘
                  ↓
┌─────────────────────────────────────────┐
│ closeloop_util.py: EvalBatchState      │
│ 初始化批次状态                          │
└─────────────────┬───────────────────────┘
                  ↓
┌─────────────────────────────────────────┐
│ model_wrapper: prepare_inputs()        │
│ ├─ 获取RGB图像                         │
│ ├─ 获取深度图                          │
│ ├─ 生成captions(Qwen_api_captions.py) │
│ ├─ 处理历史轨迹                        │
│ └─ 构建提示词(prompts.py)             │
└─────────────────┬───────────────────────┘
                  ↓
┌─────────────────────────────────────────┐
│ model_wrapper: run()                   │
│ ├─ 调用LLM API                         │
│ ├─ 解析动作和步长                      │
│ └─ 返回动作列表                        │
└─────────────────┬───────────────────────┘
                  ↓
┌─────────────────────────────────────────┐
│ env_uav.py: makeActions()              │
│ ├─ 计算下一步位置(env_utils_uav.py)   │
│ ├─ 发送指令到仿真器                   │
│ └─ 等待执行完成                        │
└─────────────────┬───────────────────────┘
                  ↓
┌─────────────────────────────────────────┐
│ env_uav.py: get_obs()                  │
│ ├─ 获取新的RGB图像                     │
│ ├─ 获取新的深度图                      │
│ ├─ 获取位置、姿态                      │
│ └─ 检测碰撞                            │
└─────────────────┬───────────────────────┘
                  ↓
┌─────────────────────────────────────────┐
│ EvalBatchState: update_from_env_output │
│ ├─ 记录轨迹                            │
│ ├─ 更新距离                            │
│ ├─ 检查成功条件                        │
│ └─ 检查终止条件                        │
└─────────────────┬───────────────────────┘
                  ↓
            是否终止？
              ↙  ↘
            是      否 → 回到prepare_inputs
             ↓
         保存结果(closeloop_util.py)
```

### 5. 结果分析阶段
```
closeloop_util.py → 保存轨迹JSONL
                 → 保存任务描述JSON
                 ↓
classify_metric.py → 读取所有日志
                   → 计算指标
                   → 输出统计表格
                   ↓
Task_visualization.py → 读取轨迹
                      → 生成3D可视化
```

### 6. 关键数据流

**视觉数据流**：
```
AirSim仿真器 → AirVLNSimulatorClientTool (捕获图像)
            → env_uav.py (组织批次)
            → model_wrapper (处理图像)
            → Qwen_api_captions (生成描述)
            → prompts (嵌入提示词)
            → LLM API (理解场景)
```

**动作执行流**：
```
LLM API (预测动作) → model_wrapper (解析动作)
                  → env_uav.py (批量执行)
                  → env_utils_uav.py (计算位置)
                  → VectorEnvUtil (分发到进程)
                  → AirVLNSimulatorClientTool (发送指令)
                  → AirSim仿真器 (执行移动)
```

**配置流**：
```
命令行参数 → param.py (解析存储)
          → airsim_settings.py (动作参数)
          → prompts.py (提示词模板)
          → 所有模块 (读取配置)
```

### 7. 核心模块依赖图

```
                    param.py (全局配置中心)
                        ↓
        ┌───────────────┼───────────────┐
        ↓               ↓               ↓
  eval_*.py      model_wrapper    env_uav.py
        ↓               ↓               ↓
closeloop_util ← prompts.py    env_vector_uav.py
        ↓                               ↓
  EvalBatchState              AirVLNSimulatorClientTool
        ↓                               ↓
  save_logs                   AirVLNSimulatorServerTool
        ↓
  classify_metric.py
  Task_visualization.py
```

---

## 总结

该项目是一个完整的具身AI导航系统，核心特点：

1. **模块化设计**：仿真、环境、模型、评估各司其职
2. **可扩展性**：基类设计支持添加新模型（BaseModelWrapper）
3. **并行化**：多进程仿真提高效率（VectorEnvUtil）
4. **多模态融合**：视觉（RGB+深度）+ 语言（LLM推理）
5. **完整评估流程**：数据加载 → 环境交互 → 模型推理 → 结果分析 → 可视化

各文件通过清晰的接口协同工作，形成从数据到评估的完整闭环。
